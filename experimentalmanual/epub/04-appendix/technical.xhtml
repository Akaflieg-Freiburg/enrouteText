<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Technical Notes</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="technical-notes">
<h1>Technical Notes</h1>
<div class="section" id="platform-notes">
<h2>Platform notes</h2>
<div class="section" id="android">
<h3>Android</h3>
<p>Wi-Fi locking</p>
<blockquote>
<div><p>When running on Android, the app acquires a Wi-Fi lock as soon as the app
receives heartbeat messages from one of the channels where it listens for
traffic receivers.  The lock is released when the messages no longer arrive.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="traffic-receiver">
<h2>Traffic Receiver</h2>
<div class="section" id="communication">
<h3>Communication</h3>
<p><strong>Enroute Flight Navigation</strong> expects that the traffic receiver deploys a WLAN
network via Wi-Fi and publishes traffic data via that network.  In order to
support a wide range of devices, including flight simulators, the app listens to
several network addresses simultaneously and understands a variety of protocols.</p>
<p><strong>Enroute Flight Navigation</strong> watches the following data channels, in order of
preference.</p>
<ul class="simple">
<li><p>A TCP connection to port 2000 at the IP addresses 192.168.1.1, where the app
expects a stream of FLARM/NMEA sentences.</p></li>
<li><p>A TCP connection to port 2000 at the IP addresses 192.168.10.1, where the app
expects a stream of FLARM/NMEA sentences.</p></li>
<li><p>A UDP connection to port 4000, where the app expects datagrams in GDL90 or
XGPS format.</p></li>
<li><p>A UDP connection to port 49002, where the app expects datagrams in GDL90 or
XGPS format.</p></li>
</ul>
<p><strong>Enroute Flight Navigation</strong> expects traffic data in the following formats.</p>
<ul class="simple">
<li><p>FLARM/NMEA sentences must conform to the specification outlined in the
document FTD-012 <a class="reference external" href="https://flarm.com/support/manuals-documents/">Data Port Interface Control Document (ICD)</a><span class="link-target"> [https://flarm.com/support/manuals-documents/]</span>, Version 7.13, as published
by <a class="reference external" href="https://flarm.com/">FLARM Technology Ltd.</a><span class="link-target"> [https://flarm.com/]</span>.</p></li>
<li><p>Datagrams in GDL90 format must conform to the <a class="reference external" href="https://www.faa.gov/nextgen/programs/adsb/archival/media/gdl90_public_icd_reva.pdf">GDL 90 Data Interface
Specification</a><span class="link-target"> [https://www.faa.gov/nextgen/programs/adsb/archival/media/gdl90_public_icd_reva.pdf]</span>.</p></li>
<li><p>Datagrams in XGPS format must conform to the format specified on the
<a class="reference external" href="https://www.foreflight.com/support/network-gps/">ForeFlight Web site</a><span class="link-target"> [https://www.foreflight.com/support/network-gps/]</span>.</p></li>
</ul>
</div>
<div class="section" id="known-issues">
<h3>Known issues</h3>
<p>The GDL90 protocol has a number of shortcomings, and we recommend to use
FLARM/NMEA whenever possible.  We are aware of the following issues.</p>
<p>Altitude measurements</p>
<blockquote>
<div><p>According to the GDL90 Specification, the ownship geometric height is reported
as height above WGS-84 ellipsoid.  There are however many devices on the
market that wrongly report height above main sea level.  Different apps have
different strategies to deal with these shortcomings.</p>
<ul class="simple">
<li><p><strong>Enroute Flight Navigation</strong> as well as the app Skydemon expect that
traffic receivers comply with the GDL90 Specification.</p></li>
<li><p>ForeFlight has extended the GDL90 Specification so that traffic receivers
can indicate if they comply with the specification or not.</p></li>
<li><p>Many other apps expect wrong GDL90 implementations and interpret the
geometric height has height above main sea level.</p></li>
</ul>
</div></blockquote>
<p>MODE-S traffic</p>
<blockquote>
<div><p>Most traffic receivers see traffic equipped with MODE-S transponders and can
give an estimate for the distance to the traffic.  They are, however, unable
to obtain the precise traffic position.  Unlike FLARM/NMEA, the GDL90
Specification does not support traffic factors whose position is unknown.
Different devices implement different workarounds.</p>
<ul class="simple">
<li><p>Stratux devices generate a ring of eight virtual targets around the own
position.  These targets are named “Mode S”.</p></li>
<li><p>Air Avioncs devices do the same, but only with one target.</p></li>
<li><p>Other devices create a virtual target, either at the ownship position or at
the north pole and abuse the field “Navigation Accuracy Category for
Position” to give the approximate position to the target.</p></li>
</ul>
<p><strong>Enroute Flight Navigation</strong> has special provisions for handling targets
called “Mode S”, but users should expect that this workaround is not perfect.</p>
</div></blockquote>
</div>
<div class="section" id="foreflight-broadcast">
<h3>ForeFlight Broadcast</h3>
<p>Following the standards established by the app ForeFlight, <strong>Enroute Flight
Navigation</strong> broadcasts a UDP message on port 63093 every 5 seconds while the
app is running in the foreground.  This message allows devices to discover
Enroute’s IP address, which can be used as the target of UDP unicast messages.
This broadcast will be a JSON message, with at least these fields:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nt">&quot;App&quot;</span><span class="p">:</span><span class="s2">&quot;Enroute Flight Navigation&quot;</span><span class="p">,</span>
   <span class="nt">&quot;GDL90&quot;</span><span class="p">:{</span>
      <span class="nt">&quot;port&quot;</span><span class="p">:</span><span class="mi">4000</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The GDL90 “port” field is currently 4000, but might change in the future.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>